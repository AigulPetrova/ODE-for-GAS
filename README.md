# ODE-for-GAS
Подход к определению динамики запаса газа на основе нейронных дифференциальных уравнений
Уравнение для расчета запаса газа:
Q_(зап )=V  (P T_c)/(Z T P_c )(1)	Р –давление на участке, кгс/см2;
T- температура на участке, °C;
Z - коэффициент сжимаемости;
Рс = 0,1013 МПа и Tc = 293,15 К
Численно решить данные уравнения не представятся возможным ввиду неопределённости большого числа нелинейно меняющихся факторов. 
Для решения таких задач в настоящее время исследуется применение алгоритмов машинного обучения, и в частности, нейронных сетей с использованием обыкновенного дифференциального уравнения ОДУ (ODE, ordinary differential equation). 
На данном этапе рассматривалась динамика одного из факторов уравнения (1), температуры газа в нитке магистрального газопровода, остальные для простоты расчетов были зафиксированы. 
Тогда, уравнение динамики запаса газа в зависимости от изменения температуры газопроводе можно представить в виде:  
(dQ_(зап  ))/dt  =  C ∙(dQ_(зап ))/dT  /   dT/dt  					(2)
Можно записать уравнение 5 в следующем виде:
Q_(зап )' = 〖C ∙Q〗_(зап )/T 					 	(3)
Это ОДУ имеет аналитическое решение
Q_(зап )^'=  C∙T+ C_(1 )         			                 (4)
где С и С1  - коэффициенты. 
На вход нейросети, для решения дифференциального уравнения динамики запаса газа в зависимости от динамики температуры газа в нитке газопровода, подавалась тренировочная выборка значений. Сеть обучалась с помощью цикла в среде Matlab. 
В течение каждой эпохи данные группировались по мини-пакетам. Для каждого мини-пакета оценивались градиенты модели и потерь с помощью функций dlfeval и modelGradients. Сетевые параметры обновлялись при помощи функции sgdmupdate. 
Путем экспериментов удалось подобрать коэффициенты С и С1, формулы 11, для температуры на входе нитки газопровода, чтобы получить максимальное приближение к значениям запаса, полученным аналитически. Результаты представлены в таблице 1. 
Таблица 1 результаты нейросетевой модели 
С	С1	Ошибка RMSE
0.9	1.25	0.016

Исходный пример: https://www.mathworks.com/help/deeplearning/ug/solve-odes-using-a-neural-network.html 
Ссылка на скрипты в Матлаб: https://disk.yandex.ru/d/6v3Db2_4C91w2g 
